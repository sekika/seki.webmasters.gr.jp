<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html lang="ja">
<head>
  <meta http-equiv="Content-Type"
 content="text/html;CHARSET=ISO-2022-JP">
  <title>プログラム作成の基本方針</title>
  <meta name="author" content="Katsutoshi Seki">
  <meta name="copyright" content="&#169; 1996-2002 Katsutoshi Seki">
  <meta name="DESCRIPTION" content="Katsutoshi Seki">
  <meta name="keywords" content="shogi, chess, backgammon, game, diary">
  <link rev="MADE" href="mailto:seki@ylug.org">
  <link rel="stylesheet" type="text/css" href="seki.css">
</head>
<body>
<a href="http://purl.org/net/seki/"><img src="icons/logo.png"
 alt="バナー" width="82" height="39" align="right" border="0"></a><br
 clear="all">
<h1>プログラム作成の基本方針</h1>
<p>私が作成するプログラムの、基本的な方針についてここに記述します。ここに書いてあることは、各プログラムの説明ファイルの中で簡単に説明してあることもありますし、いちいちことわらないこともあります。</p>
<hr> <a name="language">
<h2>プログラミング言語</h2>
</a>
<p>これは、今後他の言語も使う可能性もあるという点において基本方針ではないのですが、はじめに記述しておきます。今のところ、Microsoft
Visual Basic 4.0
（以下、VB4と略記）を使ってプログラミングしています。以下の基本方針は、この言語を使うということが前提としてあります。</p>
<a name="registry">
<h2>レジストリはいじらない</h2>
</a>
<p>VB4では、各種の設定はレジストリに記憶させておくことが奨励され、簡単にレジストリの設定を読み書きできるようになっています。レジストリとは何か、簡単に説明しますと、Windowsのいろいろなプログラム(Windows自体も含む）の設定を記憶する為の特殊なデータベースファイル（Windowsをインストールしたフォルダの中の、User.datとSystem.datというファイル）です。中身を見たければ、Windowsに標準で用意されているレジストリエディタというソフトを使えば見ることはできますが、何の予備知識もなくこのレジストリを書き換えることは危険です。レジストリエディタは、「スタート」「ファイル名を指定して実行」として、「regedit」と入力してリターンキーを押せば、起動できます。Visual
Basicで作るソフトは、レジストリの \HKEY_CURRENT_USER\Software\VB and VBA Program
Settings
というキーの下しか使わないことになっているので、プログラムのミスでWindowsが使う重要なレジストリを破壊する危険はほとんどありませんが、それでも通常のユーザーはこわくていじれないレジストリなんていうところにひっそりと設定を保存しておくのはいやです。</p>
<p>前置きが長くなりましたが、私のプログラムは、少なくとも公開しているものに関しては、すべて<b>レジストリを使わずに、テキストファイルに設定を保存</b>しています。その初期設定ファイルは、アプリケーションがインストールされたフォルダの中に、アプリケーションのファイル名の拡張子exeをiniに変えた名前のファイルとすることに統一します。たとえば、doho.exeというプログラムであればdoho.iniというファイル名の初期設定ファイルが作成されるわけです（iniファイルは配付ファイルの中にはありませんが、一度プログラムを実行して終了すると自動的に作成されます）。この設定ファイルはテキストファイルなので、メモ帳などのエディタやワープロで見ることも書き換えることもできます。もちろん、書き換えるときにはその内容を理解していないといけませんが、少なくともレジストリをいじるときのような危険性（Windowsの重要な設定を壊してしまうという危険性）はないので、安心できるはずです。また、他のパソコンにプログラムを移動するときも、初期設定ファイルと一緒にプログラムの保存されているフォルダを丸ごとコピーすれば、設定もそのまま引き継がれることになります。そして、プログラムをアンインストールするときも、インストールしたフォルダを丸ごと削除するだけで簡単にインストール前の状態に戻ります。</p>
<!-- p>VBプログラマーの方のために、初期設定ファイルを読み書きするための関数およびルーチンが入った<a href="inifile.bas">モジュール</a>を置いておきます。単にAPIを呼び出しているだけなので、API呼び出しの方法が変わらなければ、VB4以外のバージョンでもそのまま使えるはずです。著作権を主張するほどのものでもないので、配布、転載、改変等ご自由にしてください。内容は、ソースを読んで理解してください。</P --> <a
 name="installer">
<h2>インストーラーは作らない</h2>
</a>
<p>インストーラーは作らずに、exeファイルと説明ファイルのみ（場合によっては、その他のファイルが含まれることもあります）を配布します。VB4で作成しているプログラムを動かすためには、VB4のランタイムライブラリというファイル（VB40032.dllとVB4JP32.dll）が必要です。過去にVB4のアプリケーションをインストールしたことがあれば、すでにこれらはあるはずです。もしもなければ、私のプログラムを起動したときに「***.dllが見つかりません」というエラーが出ますので、その時は別途ランタイムライブラリをインストールしてください。Vector
Designのホームページにおいてある、<a href="http://%20%20">Hello! </a>をインストールすればOKです。</p>
<p>インストーラーを作ればいいのですが、実行ファイルはそんなに大きくないのに、インストーラーのファイルサイズが大きくなってしまうのが、どうもいやです。ダウンロードするのにも時間がかかってしまいますし、インストーラーをつけるほどのプログラムはないのでつけません。</p>
<a name="help">
<h2>ヘルプファイルは作らない</h2>
</a>
<p>これは、「作らない」ではなくて「作れない」ですが、ヘルプは作らずに、テキスト形式の説明ファイルを作るだけにしておきます。とりあえず、readme.txtというファイルにすべて説明を記述しますので、まずはそのファイルをご一読ください。ただし、どなたかヘルプファイルを作って下さる方がいれば、話は別です。そういう奇特な方がいらっしゃいましたら、<a
 href="mailto:seki@ylug.org">メール</a>ください。もっとも、私が作らずにどなたかに作っていただいたとしても、「私が」作らないという方針は変えていないことになりますが。</p>
<a name="author">
<h2>著作権について</h2>
</a>
<p>私が作成するソフトは、原則としてすべてフリーソフトとして公開します。公開されたプログラムについては、説明ファイルを含むすべてのファイルを<b>*改変せずにそのままで*</b>配付するという条件の下で、自由に転載・配付して構いません。したがって、説明ファイルの中に記述されている著作権表示および転載・配付条件を変えることもできません。また、ダウンロードしてからしばらくたっているソフトを配付する際には、バージョンアップされている可能性がありますので、このページで最新のバージョンを確認して、なるべく最新のバージョンを配付していただくようお願いします。</p>
<p>ただし、開発中のバージョンについては転載を制限する場合もありますが、そのようなソフトはこのページ上では公開していませんので、このページにあるソフトは原則的に転載自由です。</p>
<a name="support">
<h2>サポートについて</h2>
</a>
<p>前項で記したように、私はまったくお金をもらっていませんので、動作保証およびサポートをする義務は一切ありません。その前提をふまえた上で、ユーザーの皆様からの<a
 href="mailto:seki@ylug.org">メール</a>は歓迎します。動かなければ、動かないという事実とハードウェアおよびソフトウェア環境をメールしていただけば、もしかして次のバージョンでは動くようになるかもしれませんし、ならないかもしれません。私のパソコンで動いたからといって他のパソコンで必ず動くかどうかは、はっきり言って分かりません。特に、VB4もいつのまにか「昔のバージョン」になってしまいましたので、最新の環境では動かなくなってしまう可能性もあります。動かないという報告が多数来たとしても、その原因が分からなければ、直すこともできないでしょう。原因がはっきりとしているバグに関しては、なるべくすぐに直して新しいバージョンを発表するつもりではいます。</p>
<a name="source">
<h2>ソースコードについて</h2>
</a>
<p>ソースコードは、要求があれば送ります。最初の３人までは、メールで送ります。それ以上要求があれば、このページで公開します。ただし、もともと他人に読んでもらおうと思ってコードを書いていませんので、コメントはほとんどなく、とても読みにくいコードであることは、あらかじめご了承ください。ソースコードを自分に使いやすいように改変して使うことは、各自の責任の元で自由に行ってください。ソースコードの転載・配付は禁止しますので、必要なときはこのページのURLまたはリンクを示すにとどめておいてください。ソースコードを改変したものを公開するか、もしくはソースコードの一部または全部を利用してまったく別のソフトを開発する場合には、必ず事前に<a
 href="mailto:seki@ylug.org">メール</a>で許可を得てください。本当にそんな人がいたら、転載条件を検討します。「ソースコードのここをこのようになおすと、もっといいプログラムになります」というような提案および助言は、歓迎します。その提案を取り入れたバージョン（および、それ以降のバージョン）には、説明ファイルの中に謝辞としてその方の名前を記します（名前を記して欲しくない場合には、そのようにおっしゃってください）。</p>
<hr>
<ul>
  <li>Viewable with <a
 href="http://www.anybrowser.org/campaign/anybrowser_jp.html"><img
 src="icons/a-logo.png" width="88" height="31"
 alt="Viewable with any browser" border="0"></a><br>
お好みのソフトウェア（ウェブブラウザ）で閲覧してください。 </li>
  <li>Googleで「<a
 href="http://www.google.co.jp/search?q=%8BC%82%DC%82%AE%82%EA%83Q%81%5B%83%7D%81%5B&amp;hl=ja&amp;btnG=Google+%8C%9F%8D%F5&amp;lr=lang_ja">気まぐれゲーマー</a>」と検索していただくと、このページへたどりつけます。</li>
  <li><a href="index.html">ホームページへ戻る</a> </li>
  <li><a href="message.html">ご意見、ご感想</a> </li>
</ul>
<!-- a href="http://validator.w3.org/check/referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" border="1"></a -->
<div class="copyright"> Copyright (C) 1996-2002 Katsutoshi Seki. All
rights reserved.<br>
&lt;URL:http://purl.org/net/seki/policy.html&gt;<br>
Last update: $Date: 2005/03/18 11:49:18 $ (UTC) </div>
</body>
</html>
